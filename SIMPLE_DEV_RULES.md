# NFwords 开发简明规则

1. 前端统一用 MVVM，视图只负责展示和事件转发。
2. 所有业务逻辑放在视图模型或服务层，不写在视图里。
3. 所有数据库和本地存储访问只能通过存储或服务层间接进行。
4. 学习主流程必须打通：选词库 → 选计划 → 生成任务 → 开始滑卡。
5. 滑卡索引始终直接对应学习队列索引，异常用智能同步重置到队列首。
6. 提前掌握只在学习队列和进度上做“批量完成”，不在滑卡层做复杂偏移。
7. 停留时间只在真正展示的当前卡片上统计一次，由统一追踪器负责。
8. 所有影响 UI 的状态更新都在主线程执行，并通过响应式属性驱动视图。
9. 引入新状态字段时必须使用清晰语义命名，避免缩写和魔法数字。
10. 任意可能失败的逻辑使用显式错误类型和处理分支，避免强制解包崩溃。
11. 新增服务优先设计为纯逻辑、可单测组件，再由视图模型组合调用。
12. 与索引相关的数组、队列操作一律先做边界检查再访问数据。
13. 性能敏感路径（滑卡、动画）禁止执行磁盘 IO、大量日志或重型计算。
14. 交互优先级：滑卡流畅性 > 实时日志 > 非关键统计，必要时延迟统计写入。
15. 修改学习流程前先在文档中画清楚数据流和状态变化，再落地到代码。
16. 新增或调整核心逻辑时需在对应说明文档中补充 2–3 行用途与注意点。
17. 调试日志只在调试构建中打开，内容包含关键参数但不输出敏感信息。
18. 命名、缩进、空行等风格统一遵守 Swift 官方和当前项目既有风格。
19. 如实现细节与规则冲突，一律优先保证“学习闭环完整”和“滑卡稳定”。
20. 不确定的需求或改动先通过文档或讨论澄清意图，再做大范围重构。


